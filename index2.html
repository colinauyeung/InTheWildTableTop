<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>

        #videobox {
            background-color: blue;
            width: 100%;
            height: 740px;
            width: 750px;
            overflow: hidden;
        }

        .videof {
            height: 160%;
            margin-left: -570px;
            margin-top: -250px;
            z-index: 0;
        }

        #mess {
            color: white;
            z-index: 3;
            position: relative;
            top: -650px;
            width: 100%;
            text-align: center;
            font-size: 100px;
            opacity: 0;
        }
    </style>
</head>
<body>
<div id="videobox">
    <div id="mess">
        HELLO WORLd
    </div>
</div>
<script>
    const electron = require('electron');
    // var remote = require('remote');
    const remote = require('electron').remote;
    const windowManager = remote.require('electron-window-manager');

    var video;
    // // var windowManager = require("electron-window-manager");
    // const { v4: uuidv4 } = require('uuid');
    // // const remote = require('remote');

    windowManager.sharedData.watch("play",  function(prop, action, newValue, oldValue){
        let vid = document.createElement("video");
        vid.src = "./videos/" + newValue + ".mp4";
        vid.autoplay = true;
        vid.loop = true;
        vid.controls = true;
        vid.className = "videof"
        let box = document.getElementById("videobox");
        let mess = document.createElement("div");
        mess.id = "mess";
        mess.innerText = "Hello World";
        box.innerHTML = "";
        box.appendChild(vid);
        box.appendChild(mess);
        video = vid;
    })

    windowManager.sharedData.watch("playbtn", function(prop, action, newValue, oldValue){
        if(video !== null){
            let mess = document.getElementById("mess");
            if(newValue === true){
                if(video.paused){
                    mess.innerText = "Playing";
                    video.play();
                }
                else{
                    mess.innerText = "Paused";
                    video.pause();
                }
                windowManager.sharedData.set("playbtn", false);
                mess.style.opacity = "0.5";
                window.setTimeout(function(){
                    document.getElementById("mess").style.opacity = "0";
                }, 500)
            }
        }

    });

    windowManager.sharedData.watch("fastforward", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let mess = document.getElementById("mess");
                let speed = video.playbackRate;
                if(speed < 1){
                    speed = speed *2;
                }
                else{
                    speed = speed + 0.5;
                }
                if(speed > 3){
                    speed = 3;
                }
                mess.innerText = speed + "x";
                if(video.paused){
                    video.playbackRate = speed;
                }
                else{
                    video.pause();
                    video.playbackRate = speed;
                    video.play();
                }
                mess.style.opacity = "0.5";
                window.setTimeout(function(){
                    document.getElementById("mess").style.opacity = "0";
                }, 500)
                windowManager.sharedData.set("fastforward", false);
            }
        }

    });
    windowManager.sharedData.watch("rewind", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let mess = document.getElementById("mess");
                let speed = video.playbackRate;
                if(speed > 1){
                    speed = speed - 0.5;
                }
                else{
                    speed = speed/2;
                }
                if(speed < 0.125){
                    speed = 0.125
                }
                mess.innerText = speed + "x";
                if(video.paused){
                    video.playbackRate = speed;
                }
                else{
                    video.pause();
                    video.playbackRate = speed;
                    video.play();
                }
                mess.style.opacity = "0.5";
                window.setTimeout(function(){
                    document.getElementById("mess").style.opacity = "0";
                }, 500)
                windowManager.sharedData.set("rewind", false);
            }
        }

    });
    windowManager.sharedData.watch("forward", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let mess = document.getElementById("mess");
                let time = video.currentTime;
                let dur = video.duration;
                time = time + 5;
                if(time > dur){
                    time = dur;
                }
                mess.innerText = ">5s";
                if(video.paused){
                    video.currentTime = time;
                }
                else{
                    video.pause();
                    video.currentTime = time;
                    video.play();
                }
                mess.style.opacity = "0.5";
                window.setTimeout(function(){
                    document.getElementById("mess").style.opacity = "0";
                }, 500);
                windowManager.sharedData.set("forward", false);
            }
        }

    });
    windowManager.sharedData.watch("back", function(prop, action, newValue, oldValue){
        if(video !== null){
            console.log("back");
            if(newValue === true){
                let mess = document.getElementById("mess");
                let time = video.currentTime;
                time = time -5;
                if(time < 0){
                    time = 0;
                }
                mess.innerText = "5s<";
                if(video.paused){
                    video.currentTime = time;
                }
                else{
                    video.pause();
                    video.currentTime = time;
                    video.play();
                }
                mess.style.opacity = "0.5";
                window.setTimeout(function(){
                    document.getElementById("mess").style.opacity = "0";
                }, 500);
                windowManager.sharedData.set("back", false);
            }
        }

    });

    windowManager.sharedData.watch("record", function(prop, action, newValue, oldValue){
        if(newValue === true){
            let mess = document.getElementById("mess");
            mess.innerText = "Recording";
            mess.style.opacity = "0.5";
            window.setTimeout(function(){
                document.getElementById("mess").style.opacity = "0";
            }, 500);
            windowManager.sharedData.set("record", false);
        }
    })

    windowManager.sharedData.watch("process", function(prop, action, newValue, oldValue){
        if(newValue === true){
            let mess = document.getElementById("mess");
            mess.innerText = "Processing";
            mess.style.opacity = "0.5";
            window.setTimeout(function(){
                document.getElementById("mess").style.opacity = "0";
            }, 500);
            windowManager.sharedData.set("process", false);
        }
    })




</script>
</body>
</html>