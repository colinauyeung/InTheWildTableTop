<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>

        #videobox {
            background-color: blue;
            width: 100%;
            height: 500px;
            overflow: hidden;
        }

        .videof {
            /*height: 300%;*/
            /*margin-left: -700px;*/
            /*margin-top: -600px;*/
        }
    </style>
</head>
<body>
<div id="videobox"></div>

<script>
    const electron = require('electron');
    // var remote = require('remote');
    const remote = require('electron').remote;
    const windowManager = remote.require('electron-window-manager');

    var video;
    // // var windowManager = require("electron-window-manager");
    // const { v4: uuidv4 } = require('uuid');
    // // const remote = require('remote');

    windowManager.sharedData.watch("play",  function(prop, action, newValue, oldValue){
        let vid = document.createElement("video");
        vid.src = "./videos/" + newValue + ".mp4";
        vid.autoplay = true;
        vid.loop = true;
        vid.controls = true;
        vid.className = "videof"
        let box = document.getElementById("videobox")
        box.innerHTML = "";
        box.appendChild(vid);
        video = vid;
    })

    windowManager.sharedData.watch("playbtn", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                if(video.paused){
                    video.play();
                }
                else{
                    video.pause();
                }
                windowManager.sharedData.set("playbtn", false);
            }
        }

    })

    windowManager.sharedData.watch("fastforward", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let speed = video.playbackRate;
                speed = speed + 0.5;
                if(speed > 3){
                    speed = 3;
                }
                if(video.paused){
                    video.playbackRate = speed;
                }
                else{
                    video.pause();
                    video.playbackRate = speed;
                    video.play();
                }
                windowManager.sharedData.set("fastforward", false);
            }
        }

    });
    windowManager.sharedData.watch("rewind", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let speed = video.playbackRate;
                if(speed > 1){
                    speed = speed - 0.5;
                }
                else{
                    speed = speed/2;
                }
                if(speed < 0.125){
                    speed = 0.125
                }
                if(video.paused){
                    video.playbackRate = speed;
                }
                else{
                    video.pause();
                    video.playbackRate = speed;
                    video.play();
                }
                windowManager.sharedData.set("rewind", false);
            }
        }

    });
    windowManager.sharedData.watch("forward", function(prop, action, newValue, oldValue){
        if(video !== null){
            if(newValue === true){
                let time = video.currentTime;
                let dur = video.duration;
                time = time + 5;
                if(time > dur){
                    time = dur;
                }
                if(video.paused){
                    video.currentTime = time;
                }
                else{
                    video.pause();
                    video.currentTime = time;
                    video.play();
                }
                windowManager.sharedData.set("forward", false);
            }
        }

    });
    windowManager.sharedData.watch("back", function(prop, action, newValue, oldValue){
        if(video !== null){
            console.log("back");
            if(newValue === true){
                let time = video.currentTime;
                time = time -5;
                if(time < 0){
                    time = 0;
                }
                if(video.paused){
                    video.currentTime = time;
                }
                else{
                    video.pause();
                    video.currentTime = time;
                    video.play();
                }
                windowManager.sharedData.set("back", false);
            }
        }

    });




</script>
</body>
</html>